FROM python:3.10-slim

# Set working directory
WORKDIR /app

# Copy mms-consumer source code
COPY services/mms-consumer/ /app/

# Copy model-builder into /app/model-builder
COPY services/model-builder/ /app/model-builder/

# Copy orchestration module into /app/orchestration
COPY services/orchestration/ /app/orchestration/

# Copy model config (from mms_api if needed)
COPY services/mms_api/model_config.json /app/model_config.json

# Ensure all modules are discoverable
ENV PYTHONPATH="${PYTHONPATH}:/app:/app/model-builder"

# Install dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Default command
CMD ["python", "scheduler.py"]
